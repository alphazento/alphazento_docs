# Zento_VueTheme Module

Zento_VueTheme is multiple page vue application, and it's alphazento default frontend theme.

## Directory Structure

```bash

VueTheme
    |
    |----Config
    |
    |----Http
    |      |
    |      |---Controllers
    |
    |----resources
    |      |
    |      |----views   //blade template which will render vue application
    |      |
    |      |----vue     //all vue resource here
    |      |     |
    |      |     |---components
    |      |     |---store
    |      |     |---_frontstore.asm.js
    |      |     |---app.js
    |      |     |---bootstrap.js
    |      |     |---routeapp.js
    |      |     |---theme.scss
    |      |
    |------ _zento_assembly.php

```

## Page Render Process

Here we use home page as an example:

### 1. Http controller matches http request

Class Zento\BladeTheme\Http\Controllers\GeneralController function home()

### 2. Http controller function handle the request

```js

class GeneralController extends \App\Http\Controllers\Controller
{
    use TraitCartHelper;

    /**
        * Render home page
        * @group Web Pages
        */
    public function home()
    {
        return BladeTheme::breadcrumb('/', 'Home')
            ->view('page.home');
    }
```

It will return blade view page.home

### 3. page.home blade view template

The page.home blade view template which contains vue js code, and render as a vue page application

Here's the home page code.

```js

@extends('layout.frame', 'nav_page' => 'home'])

@push('head')
    <title>Home | Alphazento</title>
@endpush

@section('pagecontent')
    <section>
        <!-- This comp. can have a modal included. -->
        <image-carousel :speed="1" :img-data="carousel">
    </image-carousel>
    </section>
    <section>
        <image-gallery :cards="gallery">
        </image-gallery>
    </section>
    <section>
        <h1 class="index_h1">HOT PRODUCTS</h1>
        <product-grid :dataset="topsale" :gerneral-mode="true"></product-grid>
        <a href="/products" class="b_more">MORE</a>
    </section>
@endsection

@push('tail')
    <script>
        const store = window.vStore.default;
        const app = new Vue({
            el: '#app',
            store,
            vuetify: new Vuetify(),
            data() {
                var pageData = @json($pageData);
                return pageData;
            },
            created() {
                console.log('data', this.$data)
                this.$store.dispatch('BIND_CUSTOMER', window.appData.user);
            }
        });
    </script>
@endpush
```

## Pages

Here are some vue pages already defined.

### Home Page

See the file **resources/views/page/home.blade.php**

### Product Page

See the file **resources/views/page/product.blade.php**

### Search Result Page

See the file **resources/views/page/searchresult.blade.php**

### Shopping Cart Page

See the file **resources/views/page/shoppingcart.blade.php**

### Checkout Page

See the file **resources/views/page/checkout/index.blade.php**

## Vuex Store

## bootstrap.js

bootstrap.js prepares axios library for Vue app, and also connect some header for request.

### Axios Library

```js
window.axios = require("axios");

window.axios.defaults.headers.common["X-Requested-With"] = "XMLHttpRequest";
```

Connect Laravel CSRF token.

```js
let token = document.head.querySelector('meta[name="csrf-token"]');
if (token) {
  window.axios.defaults.headers.common["X-CSRF-TOKEN"] = token.content;
} else {
  console.error(
    "CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token"
  );
}
```

Connect API Guest Token

```js
let apiguesttoken = document.head.querySelector('meta[name="api-guest-token"]');
if (apiguesttoken) {
  window.axios.defaults.headers.common["Authorization"] = apiguesttoken.content;
} else {
  console.error("api-guest-token not found");
}
```

And also pre-parse API response.

```js
window.axios.interceptors.response.use((resoponse) => {
  return resoponse.data;
});
```

## app.js

The app.js just require all libraries for the Vue application.

```js
require("./bootstrap");
window.Vue = require("vue");
window.vStore = require("./store/store.js");

require("./._app.support");
```

## \_frontstore.asm.js

The \_frontstore.asm.js just map Vue components name and it's Vue component's file.

So in the app scope you can use component name as component tag.

### .\_app.support.js

The .\_app.support.js file is auto generated by running "php artisan vueproject:prepare" command.

It will help to load \_frontstore.asm.js(or \_backend.asm.js) defined components and routes to Vue application. And it also help to alias the vue path of different Zento Module, so you don't need to include the absolute file path but only require alias module path.
